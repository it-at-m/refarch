package de.muenchen.oss.digiwf.address.integration;


import com.github.tomakehurst.wiremock.junit5.WireMockTest;
import de.muenchen.oss.digiwf.address.integration.adapter.in.streaming.dto.*;
import de.muenchen.oss.digiwf.integration.e2e.test.DigiwfE2eTest;
import de.muenchen.oss.digiwf.integration.e2e.test.DigiwfIntegrationE2eTestUtility;
import de.muenchen.oss.digiwf.integration.e2e.test.DigiwfWiremockUtility;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;

import java.util.List;
import java.util.Map;
import java.util.UUID;

import static org.assertj.core.api.Assertions.assertThat;

/**
 * E2e tests for address-integration-service using embedded kafka and wiremock to fake infrastructure components
 */
@DigiwfE2eTest
@WireMockTest(httpPort = 8189)
class AddressIntegrationE2eTest {

    private String processInstanceId;

    @Autowired
    private DigiwfIntegrationE2eTestUtility digiWFIntegrationE2eTestUtility;

    @BeforeEach
    void setup() {
        this.processInstanceId = UUID.randomUUID().toString();
    }

    @Test
    void shouldStart() {
        // test fails if application context can not start
    }

    @Test
    void testSearchAddressesGermany() {
        final SearchAdressenDeutschlandDto searchAdressenDeutschlandDto = SearchAdressenDeutschlandDto.builder()
                .ortsname("Augsburg")
                .build();

        final String expectedResponse = "{\"page\":{\"size\":20,\"number\":0,\"totalElements\":10000,\"numberOfElements\":20,\"totalPages\":500},\"content\":[{\"score\":0.0,\"adresse\":{\"buchstabe\":null,\"hausnummer\":1,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357327.36,\"east\":3.264242428E7},\"wgs\":null},\"adresse\":\"Ablaßweg 1, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":null,\"hausnummer\":3,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357315.11,\"east\":3.264244442E7},\"wgs\":null},\"adresse\":\"Ablaßweg 3, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":null,\"hausnummer\":5,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357304.14,\"east\":3.264246709E7},\"wgs\":null},\"adresse\":\"Ablaßweg 5, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"a\",\"hausnummer\":5,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357315.24,\"east\":3.264248872E7},\"wgs\":null},\"adresse\":\"Ablaßweg 5a, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"b\",\"hausnummer\":5,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357316.11,\"east\":3.264251147E7},\"wgs\":null},\"adresse\":\"Ablaßweg 5b, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"c\",\"hausnummer\":5,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357323.66,\"east\":3.264254305E7},\"wgs\":null},\"adresse\":\"Ablaßweg 5c, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"d\",\"hausnummer\":5,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357317.28,\"east\":3.264254474E7},\"wgs\":null},\"adresse\":\"Ablaßweg 5d, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"e\",\"hausnummer\":5,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357311.0,\"east\":3.264254641E7},\"wgs\":null},\"adresse\":\"Ablaßweg 5e, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"f\",\"hausnummer\":5,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357303.02,\"east\":3.264254852E7},\"wgs\":null},\"adresse\":\"Ablaßweg 5f, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":null,\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357281.97,\"east\":3.264248795E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"a\",\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357284.75,\"east\":3.264249675E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7a, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"b\",\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357287.12,\"east\":3.264250114E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7b, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"c\",\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357289.51,\"east\":3.264250563E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7c, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"d\",\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357295.63,\"east\":3.264251808E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7d, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"e\",\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357297.82,\"east\":3.264252277E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7e, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"f\",\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357299.97,\"east\":3.264252729E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7f, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"g\",\"hausnummer\":7,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357302.22,\"east\":3.264253209E7},\"wgs\":null},\"adresse\":\"Ablaßweg 7g, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":null,\"hausnummer\":11,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357227.22,\"east\":3.264257849E7},\"wgs\":null},\"adresse\":\"Ablaßweg 11, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"1/2\",\"hausnummer\":11,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357223.85,\"east\":3.264258456E7},\"wgs\":null},\"adresse\":\"Ablaßweg 11 1/2, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}},{\"score\":0.0,\"adresse\":{\"buchstabe\":\"1/3\",\"hausnummer\":11,\"ortsname\":\"Augsburg\",\"strasseId\":\"00000\",\"strassenname\":\"Ablaßweg\",\"position\":{\"utm\":{\"north\":5357220.28,\"east\":3.264259035E7},\"wgs\":null},\"adresse\":\"Ablaßweg 11 1/3, 86161 Augsburg\",\"geozuordnungen\":{\"postleitzahl\":\"86161\",\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"61\",\"ortsteil\":\"0000\",\"ortsteilname\":\"Spickel\",\"regierungsbezirk\":\"7\",\"gemeindeschluessel\":\"09761000\"}}}]}";
        DigiwfWiremockUtility.setupGET("/v2/adresse_bundesweit/search?ortsname=Augsburg", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(searchAdressenDeutschlandDto, processInstanceId, "addressIntegration", "searchAddressesGermany", 30);

        // assert
        assertThat(payload)
                .isNotNull()
                .containsKey("response");
        final Map<String, Object> response = (Map<String, Object>) payload.get("response");
        assertThat(response).containsKey("content");
        final List<Map<String, Object>> content = (List) response.get("content");
        assertThat(content).hasSize(20);
        content.forEach(c -> {
            assertThat(c).containsKey("adresse");
            final Map<String, Object> address = (Map<String, Object>) c.get("adresse");
            assertThat(address).containsKey("ortsname");
            assertThat(address).containsEntry("ortsname", "Augsburg");
        });
    }

    @Test
    void testCheckAddressMunich() {
        final CheckAdresseMuenchenDto checkAdresseMuenchenDto = CheckAdresseMuenchenDto.builder()
                .adresse("Agnes-Pockels-Bogen 21, 80992 München")
                .build();

        final String expectedResponse = "{\"adresse\":\"Agnes-Pockels-Bogen 21, 80992 München\",\"adressId\":\"106548002103203220131218\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338764.625783518,\"east\":688470.5810078823},\"wgs\":{\"lat\":48.1741495213055,\"lon\":11.5352020030272,\"geohash\":\"u284n3zdv8q5\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.34\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2013-12-18\",\"status\":\"AKTIV\"}}";

        DigiwfWiremockUtility.setupGET("/v2/adresse/check?adresse=Agnes-Pockels-Bogen%2021%2C%2080992%20M%C3%BCnchen", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(checkAdresseMuenchenDto, processInstanceId,"addressIntegration", "checkAddressMunich");

        assertThat(payload)
                .isNotNull()
                .containsKey("response");
        final Map<String, Object> response = (Map<String, Object>) payload.get("response");
        assertThat(response).containsEntry("adresse", checkAdresseMuenchenDto.getAdresse());
    }

    @Test
    void testListAddressesMunich() {
        final ListAdressenMuenchenDto listAdressenMuenchenDto = ListAdressenMuenchenDto.builder()
                .plz(List.of("80992"))
                .build();

        final String expectedResponse = "{\"page\":{\"size\":20,\"number\":0,\"totalElements\":2029,\"numberOfElements\":20,\"totalPages\":102},\"content\":[{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 10, 80992 München\",\"adressId\":\"100004001003203219620220\",\"buchstabe\":null,\"hausnummer\":10,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339250.841383503,\"east\":687545.5557042949},\"wgs\":{\"lat\":48.1787933598559,\"lon\":11.5229861627804,\"geohash\":\"u284n4wvc411\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.16\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1962-02-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 11, 80992 München\",\"adressId\":\"100004001103203219620220\",\"buchstabe\":null,\"hausnummer\":11,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339261.046283501,\"east\":687517.6033041927},\"wgs\":{\"lat\":48.178893332689,\"lon\":11.5226150097183,\"geohash\":\"u284n4ww2ksm\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.15\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1962-02-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 12, 80992 München\",\"adressId\":\"100004001203203219620220\",\"buchstabe\":null,\"hausnummer\":12,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339264.1490835035,\"east\":687545.9746043013},\"wgs\":{\"lat\":48.1789128481293,\"lon\":11.5229976651643,\"geohash\":\"u284n4wy923c\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.16\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1962-02-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 13, 80992 München\",\"adressId\":\"100004001303203219601020\",\"buchstabe\":null,\"hausnummer\":13,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339278.991083501,\"east\":687517.7048041917},\"wgs\":{\"lat\":48.179054593746,\"lon\":11.5226242917552,\"geohash\":\"u284n4wx2der\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.15\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1960-10-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 14, 80992 München\",\"adressId\":\"100004001403203219601020\",\"buchstabe\":null,\"hausnummer\":14,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339281.447583497,\"east\":687545.816204299},\"wgs\":{\"lat\":48.1790683767868,\"lon\":11.5230031703422,\"geohash\":\"u284n4wz3mmc\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.16\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1960-10-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 15, 80992 München\",\"adressId\":\"100004001503203219601020\",\"buchstabe\":null,\"hausnummer\":15,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339293.121683501,\"east\":687518.0563041989},\"wgs\":{\"lat\":48.1791814983238,\"lon\":11.5226352506785,\"geohash\":\"u284n4y80f7s\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.15\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1960-10-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 16, 80992 München\",\"adressId\":\"100004001603203219601020\",\"buchstabe\":null,\"hausnummer\":16,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339302.825883506,\"east\":687546.3282043086},\"wgs\":{\"lat\":48.1792603775161,\"lon\":11.5230194857074,\"geohash\":\"u284n4yb9c44\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.16\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1960-10-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 17, 80992 München\",\"adressId\":\"100004001703203220001212\",\"buchstabe\":null,\"hausnummer\":17,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339343.5290835,\"east\":687515.7939041938},\"wgs\":{\"lat\":48.1796352364868,\"lon\":11.5226270878272,\"geohash\":\"u284n4yd8wvq\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.14\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"WIEDERERTEILUNG\",\"wirkungsdatum\":\"2000-12-12\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 18, 80992 München\",\"adressId\":\"100004001803203219701214\",\"buchstabe\":null,\"hausnummer\":18,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339347.719083505,\"east\":687550.2969043273},\"wgs\":{\"lat\":48.1796627139154,\"lon\":11.5230926346787,\"geohash\":\"u284n4yfgs0d\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.13\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1970-12-14\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 18a, 80992 München\",\"adressId\":\"100004001809703219701214\",\"buchstabe\":\"a\",\"hausnummer\":18,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339340.0905834995,\"east\":687565.662104391},\"wgs\":{\"lat\":48.1795896122626,\"lon\":11.5232957659683,\"geohash\":\"u284n4z42q2n\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.13\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1970-12-14\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 18b, 80992 München\",\"adressId\":\"100004001809803219701214\",\"buchstabe\":\"b\",\"hausnummer\":18,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339340.942883508,\"east\":687583.7922044573},\"wgs\":{\"lat\":48.1795919208889,\"lon\":11.5235397985134,\"geohash\":\"u284n4z4myyh\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.13\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1970-12-14\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 19, 80992 München\",\"adressId\":\"100004001903203219930129\",\"buchstabe\":null,\"hausnummer\":19,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339363.955283502,\"east\":687512.6529041834},\"wgs\":{\"lat\":48.1798197576584,\"lon\":11.5225938878201,\"geohash\":\"u284n4y7zcke\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.14\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1993-01-29\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 19a, 80992 München\",\"adressId\":\"100004001909703219930129\",\"buchstabe\":\"a\",\"hausnummer\":19,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339362.668483504,\"east\":687483.3332040679},\"wgs\":{\"lat\":48.1798168433546,\"lon\":11.5221992809654,\"geohash\":\"u284n4y5y8y6\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.14\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1993-01-29\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 20, 80992 München\",\"adressId\":\"100004002003203219830527\",\"buchstabe\":null,\"hausnummer\":20,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339367.564483505,\"east\":687550.026104329},\"wgs\":{\"lat\":48.1798411676919,\"lon\":11.5230977537663,\"geohash\":\"u284n4yggtk7\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.13\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1983-05-27\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 22, 80992 München\",\"adressId\":\"100004002203203219601020\",\"buchstabe\":null,\"hausnummer\":22,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339388.282683498,\"east\":687569.3561044117},\"wgs\":{\"lat\":48.1800216805782,\"lon\":11.5233666819437,\"geohash\":\"u284n4zhczhb\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.13\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1960-10-20\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 23, 80992 München\",\"adressId\":\"100004002303203219680916\",\"buchstabe\":null,\"hausnummer\":23,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339383.795683502,\"east\":687509.2839041763},\"wgs\":{\"lat\":48.1799990808297,\"lon\":11.5225573649257,\"geohash\":\"u284n4ykz4c9\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.14\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1968-09-16\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 24, 80992 München\",\"adressId\":\"100004002403203219680702\",\"buchstabe\":null,\"hausnummer\":24,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339406.486383502,\"east\":687542.9976043118},\"wgs\":{\"lat\":48.1801930789001,\"lon\":11.5230204721558,\"geohash\":\"u284n4yvcyfy\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.13\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1968-07-02\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 25, 80992 München\",\"adressId\":\"100004002503203219691013\",\"buchstabe\":null,\"hausnummer\":25,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339403.248683507,\"east\":687505.7821041632},\"wgs\":{\"lat\":48.180174961159,\"lon\":11.5225188860994,\"geohash\":\"u284n4ymy5sf\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.14\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1969-10-13\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 25a, 80992 München\",\"adressId\":\"100004002509703219980310\",\"buchstabe\":\"a\",\"hausnummer\":25,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339398.5228835065,\"east\":687472.3131040325},\"wgs\":{\"lat\":48.1801423605435,\"lon\":11.5220669948657,\"geohash\":\"u284n4yjeteb\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.14\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1998-03-10\",\"status\":\"AKTIV\"}}},{\"score\":0.0,\"adresse\":{\"adresse\":\"Abbachstraße 26, 80992 München\",\"adressId\":\"100004002603203219680702\",\"buchstabe\":null,\"hausnummer\":26,\"ortsname\":\"München\",\"strasseId\":\"4\",\"strassenname\":\"Abbachstraße\",\"strassennameKurz\":\"Abbachstr.\",\"strassennameAbgekuerzt\":\"Abbachstr.\",\"position\":{\"utm\":{\"north\":5339422.366183504,\"east\":687541.3790043013},\"wgs\":{\"lat\":48.1803362869902,\"lon\":11.5230057271783,\"geohash\":\"u284n4yyc3xu\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.3.13\",\"erhaltungssatzung\":\"Moosach\",\"gemarkung\":\"8688\",\"grundschule\":\"2216\",\"kaminkehrerbezirk\":\"22\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1011,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1968-07-02\",\"status\":\"AKTIV\"}}}]}";
        DigiwfWiremockUtility.setupGET("/v2/adresse/list?plz=80992", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(listAdressenMuenchenDto, processInstanceId, "addressIntegration", "listAddressesMunich");

        // assert
        final Map<String, Object> response = this.verifyAndGetResponseBody(payload);
        assertThat(response)
                .containsKey("content");
        final List<Map<String, Object>> content = (List) response.get("content");
        assertThat(content)
                .hasSize(20)
                .allSatisfy(c -> {
                    assertThat(c).containsKey("adresse");
                    final Map<String, Object> address = (Map<String, Object>) c.get("adresse");
                    assertThat(address)
                            .containsKey("ortsname")
                            .containsEntry("ortsname", "München");
                });
    }

    @Test
    void testListChangesMunich() {
        final ListAenderungenMuenchenDto listAenderungenMuenchenDto = ListAenderungenMuenchenDto.builder()
                .plz("80992")
                .build();

        final String expectedResponse = "{\"page\":{\"size\":20,\"number\":0,\"totalElements\":0,\"numberOfElements\":0,\"totalPages\":0},\"content\":[]}";
        DigiwfWiremockUtility.setupGET("/v2/adresse/aenderung?plz=80992", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(listAenderungenMuenchenDto, processInstanceId, "addressIntegration", "listChangesMunich");

        // assert
        final Map<String, Object> response = this.verifyAndGetResponseBody(payload);
        assertThat(response).containsEntry("content", List.of());
    }

    @Test
    void testSearchAddressesMunich() {
        final SearchAdressenMuenchenDto searchAdressenMuenchenDto = SearchAdressenMuenchenDto.builder()
                .query("Agnes-Pockels-Bogen 21")
                .build();

        final String expectedResponse = "{\"page\":{\"size\":20,\"number\":0,\"totalElements\":10000,\"numberOfElements\":20,\"totalPages\":500},\"content\":[{\"score\":58.656967,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 21, 80992 München\",\"adressId\":\"106548002103203220131218\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338764.625783518,\"east\":688470.5810078823},\"wgs\":{\"lat\":48.1741495213055,\"lon\":11.5352020030272,\"geohash\":\"u284n3zdv8q5\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.34\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2013-12-18\",\"status\":\"AKTIV\"}}},{\"score\":56.37021,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 1, 80992 München\",\"adressId\":\"106548000103203220080429\",\"buchstabe\":null,\"hausnummer\":1,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338736.141583505,\"east\":688249.2033069914},\"wgs\":{\"lat\":48.1739591135161,\"lon\":11.5322145581707,\"geohash\":\"u284n3v98hf7\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.34\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2008-04-29\",\"status\":\"AKTIV\"}}},{\"score\":56.37021,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 14, 80992 München\",\"adressId\":\"106548001403203220230116\",\"buchstabe\":null,\"hausnummer\":14,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338659.519634411,\"east\":688522.2685968899},\"wgs\":{\"lat\":48.17318948744109,\"lon\":11.535849957507045,\"geohash\":\"u284n98jhv3h\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":null,\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1014,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1074}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2023-01-16\",\"status\":\"AKTIV\"}}},{\"score\":56.37021,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 15, 80992 München\",\"adressId\":\"106548001503203220131218\",\"buchstabe\":null,\"hausnummer\":15,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338668.990883514,\"east\":688469.243707862},\"wgs\":{\"lat\":48.1732903421602,\"lon\":11.5351416328788,\"geohash\":\"u284n3xtu21n\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.34\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2013-12-18\",\"status\":\"AKTIV\"}}},{\"score\":56.37021,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 16, 80992 München\",\"adressId\":\"106548001603203220131218\",\"buchstabe\":null,\"hausnummer\":16,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338636.610383513,\"east\":688503.2350079918},\"wgs\":{\"lat\":48.1729892224462,\"lon\":11.5355840348154,\"geohash\":\"u284n3xun84c\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.27\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1009,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2013-12-18\",\"status\":\"AKTIV\"}}},{\"score\":56.299995,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 6, 80992 München\",\"adressId\":\"106548000603203220120301\",\"buchstabe\":null,\"hausnummer\":6,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338612.43858352,\"east\":688297.0375071707},\"wgs\":{\"lat\":48.172833086556,\"lon\":11.5328025498934,\"geohash\":\"u284n3tgjfby\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.27\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1009,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2012-03-01\",\"status\":\"AKTIV\"}}},{\"score\":56.299995,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 20, 80992 München\",\"adressId\":\"106548002003203220131218\",\"buchstabe\":null,\"hausnummer\":20,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338743.253783512,\"east\":688563.5832082529},\"wgs\":{\"lat\":48.1739298411386,\"lon\":11.536442265295,\"geohash\":\"u284n9b96x6u\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.27\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2013-12-18\",\"status\":\"AKTIV\"}}},{\"score\":56.299995,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 27, 80992 München\",\"adressId\":\"106548002703203220190711\",\"buchstabe\":null,\"hausnummer\":27,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338747.004483509,\"east\":688417.7171076665},\"wgs\":{\"lat\":48.1740068139826,\"lon\":11.5344838186616,\"geohash\":\"u284n3z1uvy8\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.34\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2019-07-11\",\"status\":\"AKTIV\"}}},{\"score\":56.299995,\"adresse\":{\"adresse\":\"Agnes-Pockels-Bogen 33, 80992 München\",\"adressId\":\"106548003303203220190711\",\"buchstabe\":null,\"hausnummer\":33,\"ortsname\":\"München\",\"strasseId\":\"6548\",\"strassenname\":\"Agnes-Pockels-Bogen\",\"strassennameKurz\":\"Agnes-Pockels-Bogen\",\"strassennameAbgekuerzt\":\"Agnes-Pockels-Bogen\",\"position\":{\"utm\":{\"north\":5338749.703283516,\"east\":688328.9757073119},\"wgs\":{\"lat\":48.1740573738344,\"lon\":11.5332925284088,\"geohash\":\"u284n3y61pnj\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"10.1.2.34\",\"erhaltungssatzung\":null,\"gemarkung\":\"8691\",\"grundschule\":\"3242\",\"kaminkehrerbezirk\":\"12\",\"mittelschule\":\"2218\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"44\",\"postleitzahl\":\"80992\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"10\",\"stadtbezirksteil\":\"10.1\",\"stadtbezirksviertel\":\"10.1.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1010,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":1061}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2019-07-11\",\"status\":\"AKTIV\"}}},{\"score\":22.326992,\"adresse\":{\"adresse\":\"Agnes-Miegel-Straße 21, 81927 München\",\"adressId\":\"106012002103203219840329\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"6012\",\"strassenname\":\"Agnes-Miegel-Straße\",\"strassennameKurz\":\"Agnes-Miegel-Str.\",\"strassennameAbgekuerzt\":\"Agnes-Miegel-Str.\",\"position\":{\"utm\":{\"north\":5336367.177983569,\"east\":696009.1256415176},\"wgs\":{\"lat\":48.1503225332196,\"lon\":11.6353924303334,\"geohash\":\"u283bv2xuq9m\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"13.4.3.41\",\"erhaltungssatzung\":null,\"gemarkung\":\"8666\",\"grundschule\":\"2229\",\"kaminkehrerbezirk\":\"62\",\"mittelschule\":\"2211\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"22\",\"postleitzahl\":\"81927\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"13\",\"stadtbezirksteil\":\"13.4\",\"stadtbezirksviertel\":\"13.4.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1315,\"stimmkreis\":102,\"wahlkreis\":218,\"wahlbezirk\":1361}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1984-03-29\",\"status\":\"AKTIV\"}}},{\"score\":21.962002,\"adresse\":{\"adresse\":\"Helene-Wessel-Bogen 21, 80939 München\",\"adressId\":\"106311002103203219970101\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"6311\",\"strassenname\":\"Helene-Wessel-Bogen\",\"strassennameKurz\":\"Helene-Wessel-Bogen\",\"strassennameAbgekuerzt\":\"Helene-Wessel-Bogen\",\"position\":{\"utm\":{\"north\":5341374.993783455,\"east\":692427.6685252086},\"wgs\":{\"lat\":48.1964249599076,\"lon\":11.5895570825144,\"geohash\":\"u284ptzk82b1\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"12.1.6.25\",\"erhaltungssatzung\":null,\"gemarkung\":\"8670\",\"grundschule\":\"2242\",\"kaminkehrerbezirk\":\"26\",\"mittelschule\":\"2142\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"47\",\"postleitzahl\":\"80939\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"12\",\"stadtbezirksteil\":\"12.1\",\"stadtbezirksviertel\":\"12.1.6\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1207,\"stimmkreis\":108,\"wahlkreis\":217,\"wahlbezirk\":1267}},\"wirkung\":{\"vorgang\":\"UMNUMMERIERUNG\",\"wirkungsdatum\":\"1997-01-01\",\"status\":\"AKTIV\"}}},{\"score\":21.859901,\"adresse\":{\"adresse\":\"Lucia-Popp-Bogen 21, 81245 München\",\"adressId\":\"106282002103203219941230\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"6282\",\"strassenname\":\"Lucia-Popp-Bogen\",\"strassennameKurz\":\"Lucia-Popp-Bogen\",\"strassennameAbgekuerzt\":\"Lucia-Popp-Bogen\",\"position\":{\"utm\":{\"north\":5337037.188983585,\"east\":681554.9982828505},\"wgs\":{\"lat\":48.1606353332482,\"lon\":11.4415292061054,\"geohash\":\"u281ur7kncns\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"21.4.2.50\",\"erhaltungssatzung\":null,\"gemarkung\":\"8694\",\"grundschule\":\"2093\",\"kaminkehrerbezirk\":\"06\",\"mittelschule\":\"2168\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"45\",\"postleitzahl\":\"81245\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"21\",\"stadtbezirksteil\":\"21.4\",\"stadtbezirksviertel\":\"21.4.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":2109,\"stimmkreis\":106,\"wahlkreis\":220,\"wahlbezirk\":2161}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1994-12-30\",\"status\":\"AKTIV\"}}},{\"score\":21.700283,\"adresse\":{\"adresse\":\"Agnes-Fink-Weg 21, 81739 München\",\"adressId\":\"106382002103203220020606\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"6382\",\"strassenname\":\"Agnes-Fink-Weg\",\"strassennameKurz\":\"Agnes-Fink-Weg\",\"strassennameAbgekuerzt\":\"Agnes-Fink-Weg\",\"position\":{\"utm\":{\"north\":5329019.7461837325,\"east\":698099.6060509469},\"wgs\":{\"lat\":48.0836414711876,\"lon\":11.6600549218568,\"geohash\":\"u283936edbrj\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"16.5.6.09\",\"erhaltungssatzung\":null,\"gemarkung\":\"8698\",\"grundschule\":\"2178\",\"kaminkehrerbezirk\":\"65\",\"mittelschule\":\"2297\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"24\",\"postleitzahl\":\"81739\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"16\",\"stadtbezirksteil\":\"16.5\",\"stadtbezirksviertel\":\"16.5.6\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1632,\"stimmkreis\":107,\"wahlkreis\":218,\"wahlbezirk\":1661}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2002-06-06\",\"status\":\"AKTIV\"}}},{\"score\":21.681353,\"adresse\":{\"adresse\":\"Pöckinger Straße 21, 81475 München\",\"adressId\":\"103625002103203220170517\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"3625\",\"strassenname\":\"Pöckinger Straße\",\"strassennameKurz\":\"Pöckinger Str.\",\"strassennameAbgekuerzt\":\"Pöckinger Str.\",\"position\":{\"utm\":{\"north\":5328536.954583741,\"east\":684466.4813915794},\"wgs\":{\"lat\":48.0833924142283,\"lon\":11.4769665657736,\"geohash\":\"u281t1m60dn8\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"19.4.3.18\",\"erhaltungssatzung\":null,\"gemarkung\":\"8671\",\"grundschule\":\"2212\",\"kaminkehrerbezirk\":\"56\",\"mittelschule\":\"2281\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"29\",\"postleitzahl\":\"81475\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"19\",\"stadtbezirksteil\":\"19.4\",\"stadtbezirksviertel\":\"19.4.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1904,\"stimmkreis\":101,\"wahlkreis\":219,\"wahlbezirk\":1964}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2017-05-17\",\"status\":\"AKTIV\"}}},{\"score\":21.681353,\"adresse\":{\"adresse\":\"Pöckinger Straße 21a, 81475 München\",\"adressId\":\"103625002109703220170517\",\"buchstabe\":\"a\",\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"3625\",\"strassenname\":\"Pöckinger Straße\",\"strassennameKurz\":\"Pöckinger Str.\",\"strassennameAbgekuerzt\":\"Pöckinger Str.\",\"position\":{\"utm\":{\"north\":5328530.80508375,\"east\":684462.7175915656},\"wgs\":{\"lat\":48.0833382275907,\"lon\":11.4769134200704,\"geohash\":\"u281t1m1xryu\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"19.4.3.18\",\"erhaltungssatzung\":null,\"gemarkung\":\"8671\",\"grundschule\":\"2212\",\"kaminkehrerbezirk\":\"56\",\"mittelschule\":\"2281\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"29\",\"postleitzahl\":\"81475\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"19\",\"stadtbezirksteil\":\"19.4\",\"stadtbezirksviertel\":\"19.4.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1904,\"stimmkreis\":101,\"wahlkreis\":219,\"wahlbezirk\":1964}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2017-05-17\",\"status\":\"AKTIV\"}}},{\"score\":21.605286,\"adresse\":{\"adresse\":\"Agnes-Bernauer-Straße 21, 80687 München\",\"adressId\":\"100046002103203219640615\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"46\",\"strassenname\":\"Agnes-Bernauer-Straße\",\"strassennameKurz\":\"Agnes-Bernauer-Str.\",\"strassennameAbgekuerzt\":\"Agnes-Bernauer-Str.\",\"position\":{\"utm\":{\"north\":5334788.717283594,\"east\":687099.8920019701},\"wgs\":{\"lat\":48.1388180407648,\"lon\":11.5150344794952,\"geohash\":\"u281y52uzy04\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"25.1.3.03\",\"erhaltungssatzung\":\"Agnes-Bernauer-Straße\",\"gemarkung\":\"8684\",\"grundschule\":\"2251\",\"kaminkehrerbezirk\":\"88\",\"mittelschule\":\"2252\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"41\",\"postleitzahl\":\"80687\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"25\",\"stadtbezirksteil\":\"25.1\",\"stadtbezirksviertel\":\"25.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":2515,\"stimmkreis\":101,\"wahlkreis\":220,\"wahlbezirk\":2562}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1964-06-15\",\"status\":\"AKTIV\"}}},{\"score\":21.39088,\"adresse\":{\"adresse\":\"Centa-Herker-Bogen 21, 80797 München\",\"adressId\":\"106487002103203220060718\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"6487\",\"strassenname\":\"Centa-Herker-Bogen\",\"strassennameKurz\":\"Centa-Herker-Bogen\",\"strassennameAbgekuerzt\":\"Centa-Herker-Bogen\",\"position\":{\"utm\":{\"north\":5338041.980583527,\"east\":690035.3218142024},\"wgs\":{\"lat\":48.1671884699891,\"lon\":11.5559053958391,\"geohash\":\"u284nbwf0nex\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"04.3.1.17\",\"erhaltungssatzung\":null,\"gemarkung\":\"8702\",\"grundschule\":\"2074\",\"kaminkehrerbezirk\":\"05\",\"mittelschule\":\"2727\",\"parklizenzgebietId\":38,\"parklizenzgebietName\":\"Winzererstraße\",\"polizeiinspektion\":\"43\",\"postleitzahl\":\"80797\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"04\",\"stadtbezirksteil\":\"04.3\",\"stadtbezirksviertel\":\"04.3.1\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":420,\"stimmkreis\":104,\"wahlkreis\":217,\"wahlbezirk\":461}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2006-07-18\",\"status\":\"AKTIV\"}}},{\"score\":21.378681,\"adresse\":{\"adresse\":\"Goldschaggbogen 21, 81735 München\",\"adressId\":\"105798002103203219770111\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"5798\",\"strassenname\":\"Goldschaggbogen\",\"strassennameKurz\":\"Goldschaggbogen\",\"strassennameAbgekuerzt\":\"Goldschaggbogen\",\"position\":{\"utm\":{\"north\":5331404.240283684,\"east\":698313.126252575},\"wgs\":{\"lat\":48.1050052716447,\"lon\":11.6640263808855,\"geohash\":\"u2839mjrzwbm\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"16.4.2.33\",\"erhaltungssatzung\":null,\"gemarkung\":\"8698\",\"grundschule\":\"2207\",\"kaminkehrerbezirk\":\"63\",\"mittelschule\":\"2128\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"24\",\"postleitzahl\":\"81735\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"16\",\"stadtbezirksteil\":\"16.4\",\"stadtbezirksviertel\":\"16.4.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":1626,\"stimmkreis\":107,\"wahlkreis\":218,\"wahlbezirk\":1661}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1977-01-11\",\"status\":\"AKTIV\"}}},{\"score\":21.36618,\"adresse\":{\"adresse\":\"Prälat-Höck-Bogen 12, 80995 München\",\"adressId\":\"106670001203203220150528\",\"buchstabe\":null,\"hausnummer\":12,\"ortsname\":\"München\",\"strasseId\":\"6670\",\"strassenname\":\"Prälat-Höck-Bogen\",\"strassennameKurz\":\"Prälat-Höck-Bogen\",\"strassennameAbgekuerzt\":\"Prälat-Höck-Bogen\",\"position\":{\"utm\":{\"north\":5341796.939883452,\"east\":686556.6614008478},\"wgs\":{\"lat\":48.2019694105994,\"lon\":11.5108145749061,\"geohash\":\"u284jyvuv6m7\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"24.4.2.50\",\"erhaltungssatzung\":null,\"gemarkung\":\"8669\",\"grundschule\":\"2164\",\"kaminkehrerbezirk\":\"43\",\"mittelschule\":\"2272\",\"parklizenzgebietId\":null,\"parklizenzgebietName\":null,\"polizeiinspektion\":\"43\",\"postleitzahl\":\"80995\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"24\",\"stadtbezirksteil\":\"24.4\",\"stadtbezirksviertel\":\"24.4.2\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":2401,\"stimmkreis\":105,\"wahlkreis\":217,\"wahlbezirk\":2461}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"2015-05-28\",\"status\":\"AKTIV\"}}},{\"score\":21.342459,\"adresse\":{\"adresse\":\"Agnesstraße 21, 80798 München\",\"adressId\":\"100047002103203219390101\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"47\",\"strassenname\":\"Agnesstraße\",\"strassennameKurz\":\"Agnesstr.\",\"strassennameAbgekuerzt\":\"Agnesstr.\",\"position\":{\"utm\":{\"north\":5336998.054583547,\"east\":690975.2582180499},\"wgs\":{\"lat\":48.1575241079159,\"lon\":11.5680653662995,\"geohash\":\"u281znz9gmns\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"04.1.3.10\",\"erhaltungssatzung\":\"Agnesstraße\",\"gemarkung\":\"8653\",\"grundschule\":\"2255\",\"kaminkehrerbezirk\":\"05\",\"mittelschule\":\"2727\",\"parklizenzgebietId\":4,\"parklizenzgebietName\":\"West Schwabing\",\"polizeiinspektion\":\"12\",\"postleitzahl\":\"80798\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"04\",\"stadtbezirksteil\":\"04.1\",\"stadtbezirksviertel\":\"04.1.3\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":424,\"stimmkreis\":104,\"wahlkreis\":217,\"wahlbezirk\":461}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1939-01-01\",\"status\":\"AKTIV\"}}}]}";
        DigiwfWiremockUtility.setupGET("/v2/adresse/search?query=Agnes-Pockels-Bogen%2021", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(searchAdressenMuenchenDto, processInstanceId, "addressIntegration", "searchAddressesMunich");

        // assert
        final Map<String, Object> response = this.verifyAndGetResponseBody(payload);
        assertThat(response)
                .containsKey("content");
        final List<Map<String, Object>> content = (List) response.get("content");
        assertThat(content)
                .hasSize(20)
                .allSatisfy(c -> {
                    assertThat(c).containsKey("adresse");
                    final Map<String, Object> address = (Map<String, Object>) c.get("adresse");
                    assertThat(address).containsEntry("ortsname", "München");
                });
    }

    @Test
    void testSearchAddressesGeoMunich() {
        final SearchAdressenGeoMuenchenDto searchAdressenGeoMuenchenDto = SearchAdressenGeoMuenchenDto.builder()
                .geometrie("Punkt")
                .lat(5334745.607)
                .lng(691641.878)
                .build();

        final String expectedResponse = "[{\"adresse\":{\"adresse\":\"Marienplatz 8, 80331 München\",\"adressId\":\"102996000803203219290101\",\"buchstabe\":null,\"hausnummer\":8,\"ortsname\":\"München\",\"strasseId\":\"2996\",\"strassenname\":\"Marienplatz\",\"strassennameKurz\":\"Marienpl.\",\"strassennameAbgekuerzt\":\"Marienpl.\",\"position\":{\"utm\":{\"north\":5334776.98738359,\"east\":691647.6646206338},\"wgs\":{\"lat\":48.1373592053487,\"lon\":11.5760979470438,\"geohash\":\"u281z7jkqwhk\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"01.1.4.06\",\"erhaltungssatzung\":null,\"gemarkung\":\"8651\",\"grundschule\":\"2192\",\"kaminkehrerbezirk\":\"01\",\"mittelschule\":\"2291\",\"parklizenzgebietId\":1,\"parklizenzgebietName\":\"Altstadt\",\"polizeiinspektion\":\"11\",\"postleitzahl\":\"80331\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"01\",\"stadtbezirksteil\":\"01.1\",\"stadtbezirksviertel\":\"01.1.4\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":101,\"stimmkreis\":108,\"wahlkreis\":218,\"wahlbezirk\":161}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1929-01-01\",\"status\":\"AKTIV\"}},\"distanz\":31.896965532431263},{\"adresse\":{\"adresse\":\"Marienplatz 20, 80331 München\",\"adressId\":\"102996002003203219750101\",\"buchstabe\":null,\"hausnummer\":20,\"ortsname\":\"München\",\"strasseId\":\"2996\",\"strassenname\":\"Marienplatz\",\"strassennameKurz\":\"Marienpl.\",\"strassennameAbgekuerzt\":\"Marienpl.\",\"position\":{\"utm\":{\"north\":5334710.6412835885,\"east\":691639.4472205936},\"wgs\":{\"lat\":48.1367653700624,\"lon\":11.5759577564419,\"geohash\":\"u281z7j2gr7w\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"01.2.1.11\",\"erhaltungssatzung\":null,\"gemarkung\":\"8651\",\"grundschule\":\"2192\",\"kaminkehrerbezirk\":\"01\",\"mittelschule\":\"2290\",\"parklizenzgebietId\":1,\"parklizenzgebietName\":\"Altstadt\",\"polizeiinspektion\":\"11\",\"postleitzahl\":\"80331\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"01\",\"stadtbezirksteil\":\"01.2\",\"stadtbezirksviertel\":\"01.2.1\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":101,\"stimmkreis\":108,\"wahlkreis\":218,\"wahlbezirk\":161}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1975-01-01\",\"status\":\"AKTIV\"}},\"distanz\":35.05332766225312},{\"adresse\":{\"adresse\":\"Marienplatz 21, 80331 München\",\"adressId\":\"102996002103203219290101\",\"buchstabe\":null,\"hausnummer\":21,\"ortsname\":\"München\",\"strasseId\":\"2996\",\"strassenname\":\"Marienplatz\",\"strassennameKurz\":\"Marienpl.\",\"strassennameAbgekuerzt\":\"Marienpl.\",\"position\":{\"utm\":{\"north\":5334713.128783594,\"east\":691627.6961205399},\"wgs\":{\"lat\":48.1367912660305,\"lon\":11.5758010864296,\"geohash\":\"u281z7j1psqb\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"01.2.1.11\",\"erhaltungssatzung\":null,\"gemarkung\":\"8651\",\"grundschule\":\"2192\",\"kaminkehrerbezirk\":\"01\",\"mittelschule\":\"2290\",\"parklizenzgebietId\":1,\"parklizenzgebietName\":\"Altstadt\",\"polizeiinspektion\":\"11\",\"postleitzahl\":\"80331\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"01\",\"stadtbezirksteil\":\"01.2\",\"stadtbezirksviertel\":\"01.2.1\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":101,\"stimmkreis\":108,\"wahlkreis\":218,\"wahlbezirk\":161}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1929-01-01\",\"status\":\"AKTIV\"}},\"distanz\":35.42390893431307},{\"adresse\":{\"adresse\":\"Marienplatz 19, 80331 München\",\"adressId\":\"102996001903203219690514\",\"buchstabe\":null,\"hausnummer\":19,\"ortsname\":\"München\",\"strasseId\":\"2996\",\"strassenname\":\"Marienplatz\",\"strassennameKurz\":\"Marienpl.\",\"strassennameAbgekuerzt\":\"Marienpl.\",\"position\":{\"utm\":{\"north\":5334708.722583595,\"east\":691647.9710206254},\"wgs\":{\"lat\":48.1367455581089,\"lon\":11.5760713473394,\"geohash\":\"u281z7j2y5b2\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"01.2.1.11\",\"erhaltungssatzung\":null,\"gemarkung\":\"8651\",\"grundschule\":\"2192\",\"kaminkehrerbezirk\":\"01\",\"mittelschule\":\"2290\",\"parklizenzgebietId\":1,\"parklizenzgebietName\":\"Altstadt\",\"polizeiinspektion\":\"11\",\"postleitzahl\":\"80331\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"01\",\"stadtbezirksteil\":\"01.2\",\"stadtbezirksviertel\":\"01.2.1\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":101,\"stimmkreis\":108,\"wahlkreis\":218,\"wahlbezirk\":161}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1969-05-14\",\"status\":\"AKTIV\"}},\"distanz\":37.38687135070467},{\"adresse\":{\"adresse\":\"Marienplatz 18, 80331 München\",\"adressId\":\"102996001803203219290101\",\"buchstabe\":null,\"hausnummer\":18,\"ortsname\":\"München\",\"strasseId\":\"2996\",\"strassenname\":\"Marienplatz\",\"strassennameKurz\":\"Marienpl.\",\"strassennameAbgekuerzt\":\"Marienpl.\",\"position\":{\"utm\":{\"north\":5334705.994883592,\"east\":691658.5320206743},\"wgs\":{\"lat\":48.1367178613166,\"lon\":11.5762119288198,\"geohash\":\"u281z7j89q94\",\"fragment\":true}},\"geozuordnungen\":{\"baublock\":\"01.2.1.11\",\"erhaltungssatzung\":null,\"gemarkung\":\"8651\",\"grundschule\":\"2192\",\"kaminkehrerbezirk\":\"01\",\"mittelschule\":\"2290\",\"parklizenzgebietId\":1,\"parklizenzgebietName\":\"Altstadt\",\"polizeiinspektion\":\"11\",\"postleitzahl\":\"80331\",\"verwaltungszuteilung\":{\"gemeinde\":\"000\",\"landesschluessel\":\"09\",\"kreis\":\"62\",\"ortsteil\":null,\"regierungsbezirk\":\"1\",\"stadtbezirk\":\"01\",\"stadtbezirksteil\":\"01.2\",\"stadtbezirksviertel\":\"01.2.1\",\"gemeindeschluessel\":\"09162000\"},\"wahleinteilungen\":{\"stimmbezirk\":101,\"stimmkreis\":108,\"wahlkreis\":218,\"wahlbezirk\":161}},\"wirkung\":{\"vorgang\":\"NEUERTEILUNG\",\"wirkungsdatum\":\"1929-01-01\",\"status\":\"AKTIV\"}},\"distanz\":42.95736359869069}]";
        DigiwfWiremockUtility.setupGET("/v2/adresse/search/geo?geometrie=Punkt&lat=5334745.607&lng=691641.878", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(searchAdressenGeoMuenchenDto, processInstanceId, "addressIntegration", "searchAddressesGeoMunich");

        // assert
        final Map<String, Object> response = this.verifyAndGetResponseBody(payload);
        final List<Map<String, Object>> adresseDistanzList = (List<Map<String, Object>>) response.get("addressDistances");
        assertThat(adresseDistanzList)
                .isNotEmpty()
                .allSatisfy(addressDistance -> {
                    assertThat(addressDistance).containsKey("adresse");
                    assertThat((Map<String, Object>) addressDistance.get("adresse")).containsEntry("ortsname", "München");
                });
    }

    @Test
    void testFindStreetByIdMunich() {
        final StrassenIdDto strassenIdDto = StrassenIdDto.builder()
                .strasseId(2996L)
                .build();

        final String expectedResponse = "{\"strasseId\":2996,\"strassenname\":\"Marienplatz\",\"strassennameKurz\":\"Marienpl.\",\"strassennameAbgekuerzt\":\"Marienpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":1,\"name\":\"Altstadt-Lehel\"}]}}}";
        DigiwfWiremockUtility.setupGET("/v2/strasse/2996", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(strassenIdDto, processInstanceId, "addressIntegration", "findStreetByIdMunich");

        // assert
        final Map<String, Object> response = this.verifyAndGetResponseBody(payload);
        assertThat(response)
                .containsEntry("strasseId", 2996)
                .containsEntry("strassenname", "Marienplatz");
    }

    @Test
    void testListStreetMunich() {
        final ListStrassenDto listStrassenDto = ListStrassenDto.builder()
                .strassenname("Marienplatz")
                .build();

        final String expectedResponse = "{\"page\":{\"size\":20,\"number\":0,\"totalElements\":380,\"numberOfElements\":20,\"totalPages\":19},\"content\":[{\"score\":16.099554,\"strasse\":{\"strasseId\":2996,\"strassenname\":\"Marienplatz\",\"strassennameKurz\":\"Marienpl.\",\"strassennameAbgekuerzt\":\"Marienpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":1,\"name\":\"Altstadt-Lehel\"}]}}}},{\"score\":6.6909857,\"strasse\":{\"strasseId\":3478,\"strassenname\":\"Pasinger Marienplatz\",\"strassennameKurz\":\"Pasinger Marienpl.\",\"strassennameAbgekuerzt\":\"Pasinger Marienpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":21,\"name\":\"Pasing-Obermenzing\"}]}}}},{\"score\":6.6909857,\"strasse\":{\"strasseId\":9324,\"strassenname\":\"S-Bahnhof Marienplatz\",\"strassennameKurz\":\"S-Bhf. Marienplatz\",\"strassennameAbgekuerzt\":\"S-Bahnhof Marienplatz\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[]}}}},{\"score\":6.6909857,\"strasse\":{\"strasseId\":9386,\"strassenname\":\"U-Bahnhof Marienplatz\",\"strassennameKurz\":\"U-Bhf. Marienplatz\",\"strassennameAbgekuerzt\":\"U-Bahnhof Marienplatz\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[]}}}},{\"score\":5.618189,\"strasse\":{\"strasseId\":2988,\"strassenname\":\"Mariannenplatz\",\"strassennameKurz\":\"Mariannenpl.\",\"strassennameAbgekuerzt\":\"Mariannenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":1,\"name\":\"Altstadt-Lehel\"}]}}}},{\"score\":4.9053082,\"strasse\":{\"strasseId\":2973,\"strassenname\":\"Marchgrabenplatz\",\"strassennameKurz\":\"Marchgrabenpl.\",\"strassennameAbgekuerzt\":\"Marchgrabenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":12,\"name\":\"Schwabing-Freimann\"}]}}}},{\"score\":4.9053082,\"strasse\":{\"strasseId\":2976,\"strassenname\":\"Margaretenplatz\",\"strassennameKurz\":\"Margaretenpl.\",\"strassennameAbgekuerzt\":\"Margaretenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":5,\"name\":\"Au-Haidhausen\"},{\"nummer\":6,\"name\":\"Sendling\"}]}}}},{\"score\":4.8586073,\"strasse\":{\"strasseId\":1630,\"strassenname\":\"Griechenplatz\",\"strassennameKurz\":\"Griechenpl.\",\"strassennameAbgekuerzt\":\"Griechenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":18,\"name\":\"Untergiesing-Harlaching\"}]}}}},{\"score\":4.315258,\"strasse\":{\"strasseId\":3314,\"strassenname\":\"Normannenplatz\",\"strassennameKurz\":\"Normannenpl.\",\"strassennameAbgekuerzt\":\"Normannenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":13,\"name\":\"Bogenhausen\"}]}}}},{\"score\":4.2490087,\"strasse\":{\"strasseId\":3680,\"strassenname\":\"Prinzregentenplatz\",\"strassennameKurz\":\"Prinzregentenpl.\",\"strassennameAbgekuerzt\":\"Prinzregentenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":5,\"name\":\"Au-Haidhausen\"},{\"nummer\":13,\"name\":\"Bogenhausen\"}]}}}},{\"score\":4.2490087,\"strasse\":{\"strasseId\":9401,\"strassenname\":\"U-Bahnhof Prinzregentenplatz\",\"strassennameKurz\":\"U-Bhf. Prinzreg. Pl.\",\"strassennameAbgekuerzt\":\"U-Bahnhof Prinzregentenplatz\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[]}}}},{\"score\":4.230735,\"strasse\":{\"strasseId\":2373,\"strassenname\":\"Karolinenplatz\",\"strassennameKurz\":\"Karolinenpl.\",\"strassennameAbgekuerzt\":\"Karolinenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":3,\"name\":\"Maxvorstadt\"}]}}}},{\"score\":4.1564064,\"strasse\":{\"strasseId\":2560,\"strassenname\":\"Kosegartenplatz\",\"strassennameKurz\":\"Kosegartenpl.\",\"strassennameAbgekuerzt\":\"Kosegartenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":16,\"name\":\"Ramersdorf-Perlach\"}]}}}},{\"score\":4.007048,\"strasse\":{\"strasseId\":3723,\"strassenname\":\"Raiffeisenplatz\",\"strassennameKurz\":\"Raiffeisenpl.\",\"strassennameAbgekuerzt\":\"Raiffeisenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":16,\"name\":\"Ramersdorf-Perlach\"}]}}}},{\"score\":3.9986734,\"strasse\":{\"strasseId\":1757,\"strassenname\":\"Halligenplatz\",\"strassennameKurz\":\"Halligenpl.\",\"strassennameAbgekuerzt\":\"Halligenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":15,\"name\":\"Trudering-Riem\"}]}}}},{\"score\":3.9986734,\"strasse\":{\"strasseId\":4424,\"strassenname\":\"Skabiosenplatz\",\"strassennameKurz\":\"Skabiosenpl.\",\"strassennameAbgekuerzt\":\"Skabiosenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":24,\"name\":\"Feldmoching-Hasenbergl\"}]}}}},{\"score\":3.9986734,\"strasse\":{\"strasseId\":4696,\"strassenname\":\"Theodolindenplatz\",\"strassennameKurz\":\"Theodolindenpl.\",\"strassennameAbgekuerzt\":\"Theodolindenpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":18,\"name\":\"Untergiesing-Harlaching\"}]}}}},{\"score\":3.9918282,\"strasse\":{\"strasseId\":6651,\"strassenname\":\"Maria-Nindl-Platz\",\"strassennameKurz\":\"Maria-Nindl-Pl.\",\"strassennameAbgekuerzt\":\"Maria-Nindl-Platz\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":13,\"name\":\"Bogenhausen\"}]}}}},{\"score\":3.938186,\"strasse\":{\"strasseId\":2980,\"strassenname\":\"Maria-Eck-Platz\",\"strassennameKurz\":\"Maria-Eck-Pl.\",\"strassennameAbgekuerzt\":\"Maria-Eck-Pl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":14,\"name\":\"Berg am Laim\"}]}}}},{\"score\":3.9357867,\"strasse\":{\"strasseId\":2984,\"strassenname\":\"Mariahilfplatz\",\"strassennameKurz\":\"Mariahilfpl.\",\"strassennameAbgekuerzt\":\"Mariahilfpl.\",\"geozuordnungen\":{\"verwaltungszuteilung\":{\"stadtbezirke\":[{\"nummer\":5,\"name\":\"Au-Haidhausen\"}]}}}}]}";
        DigiwfWiremockUtility.setupGET("/v2/strasse/search?strassenname=Marienplatz", expectedResponse);

        // send and receive messages
        final Map<String, Object> payload = this.digiWFIntegrationE2eTestUtility.runIntegration(listStrassenDto, processInstanceId, "addressIntegration", "listStreetMunich");

        // assert
        final Map<String, Object> response = this.verifyAndGetResponseBody(payload);
        assertThat(response).containsKey("content");
        final List<Map<String, Object>> content = (List) response.get("content");
        assertThat(content)
                .hasSize(20)
                .allSatisfy(c -> assertThat(c).containsKey("strasse"));
    }

    private Map<String, Object> verifyAndGetResponseBody(Map<String, Object> payload) {
        assertThat(payload)
                .isNotNull()
                .containsKey("response");
        return (Map<String, Object>) payload.get("response");
    }

}
